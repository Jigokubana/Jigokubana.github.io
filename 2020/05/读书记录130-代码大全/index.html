<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="keywords" content="hexo,个人博客,blog" />
  <meta name="description" content="彼岸鱼的个人博客" />
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="dns-prefetch" href="https://busuanzi.ibruce.info">
  <link rel="dns-prefetch" href="https://at.alicdn.com">
  
  <link rel="dns-prefetch" href="https://widget.daovoice.io">
  <link rel="dns-prefetch" href="https://widget-static-cdn.daovoice.io">
  <link rel="dns-prefetch" href="https://im.daovoice.io">
  
  
  <link rel="dns-prefetch" href="https://hm.baidu.com/">
  
  
  <link rel="stylesheet" type="text/css" href="/./style/main.css">
	<link rel="shortcut icon" href="/favicon.ico" title="Favicon">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
	<title>代码大全</title>
  
  <script>var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?378fe7f014810dc29a0702bf27d8b278";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();
  </script>
  
  
    <script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/9c4ca997.js","daovoice");daovoice('init',{app_id: "9c4ca997"});daovoice('update');
  </script>
  
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Lsmg的大学之路" type="application/atom+xml">
</head>
<body>
  <canvas id="pattern-placeholder" height="230"></canvas>
<div class="navbar-header">
  <a class="blog-title" href="/">Lsmg的大学之路</a>
  <a class="face-img" href="/">
    <img src="https://lsmg-img.oss-cn-beijing.aliyuncs.com/theme/tx.jpg">
  </a>
</div>
<main>
  <div class="article-title">
    
  
  <h1 class="title">
    代码大全
  </h1>
  


    <ul class="article-info">
      <li>
        发布
        <time datetime="2020-05-13T13:19:39.000Z" itemprop="datePublished">2020-05-13</time>
      </li>
      <li>
        
    更新 <time datetime="2020-12-05T02:30:39.407Z" itemprop="dateUpdated">2020-12-05</time>

      </li>
      <li id="busuanzi_container_page_pv">
        阅读 <span id="busuanzi_value_page_pv"></span>
      </li>
    </ul>
  </div>
  <div class="container">
    <div class="article">
      <div class="content">
        
        <p>距离上次什么时候写博客已经记不清了, 看了眼GitHub备份记录 已经25天了. 这25天我咕了吗? 咕是不可能咕的. 这段时间我终于做出了第一个UE4比较完善的联机游戏.<br>学习了更多的muduo自己的mongo也更加完善. 只看书写博客不写代码可不行.</p>
<p>技术类书籍慢慢开始看了, mongo写的时间不短了.  代码大全听说是神书? 来粗读看看吧</p>
<h1 id="第-部分"><a href="#第-部分" class="headerlink" title="第?部分"></a>第?部分</h1><h2 id="第六章-可以工作的类"><a href="#第六章-可以工作的类" class="headerlink" title="第六章 可以工作的类"></a>第六章 可以工作的类</h2><p>使用ADT 可以实现隐藏细节, 改动不会影响到整个程序.</p>
<p>这点感受还是有些的. 前两天自己写VPN(目前项目暂停了)的时候, 有个Buffer类, Buffer类的核心是libevent的evbuff, 我直接使用Get方法Get到这个evbuff的指针, 然后在外部进行操作.<br>起初这样只是图简单吧, 也想到了这样会写出烂代码. 后面改动核心evbuff的时候, 发现太麻烦了, 最终改成了几个简单的接口 Append Clear等, 对外隐藏了内部是什么缓冲结构</p>
<p>has a  —- 组合 包含<br>is a —- 集成 epoll(select) is a mutiplexing</p>
<p>只有一个实例的类是值得怀疑的, 同样只有一个派生类的基类也是值得怀疑的</p>
<p>拷贝对象优先使用深拷贝</p>
<p>创建类的原因</p>
<ul>
<li>为现实世界中的对象建模</li>
<li>为抽象的对象建模 形状类是抽象的 不过圆 正方形等都是真实存在的</li>
<li>降低复杂度 一个类创建结束后, 你就可以忘掉其中的细节 使用接口即可</li>
<li>隔离复杂度</li>
<li>隐藏实现细节 限制变动的影响范围 隐藏全局数据</li>
<li>让参数传递更加舒畅 成员变量 </li>
<li>复用代码</li>
</ul>
<h2 id="第七章-高质量的子程序"><a href="#第七章-高质量的子程序" class="headerlink" title="第七章 高质量的子程序"></a>第七章 高质量的子程序</h2><p>创建子程序的正当理由</p>
<ul>
<li>降低复杂度<br>一个子程序编写完毕后, 应该可以忘记其中的细节</li>
<li>引入中间,易懂的抽象<br>避免代码重复  从大块的代码中抽取子程序</li>
<li>隐藏顺序 如果某两行代码有特定的执行顺序, 可以考虑抽取出来. 感觉这里可以推广到Mutex lock后忘记unlock 或者 Buffer中读取数据后 忘记移动指针?</li>
<li>提高可移植性 这点看项目了</li>
</ul>
<p>似乎过于简单没有必要写成子程序, 当然也要看情况了</p>
<ul>
<li>这里我感觉最深的还是 两行或者三行经常调用的程序, 如果重复写多次 最终告知你需要修改的时候 那可真是灾难性的消息. 实例的话: 增加参数校验等等</li>
</ul>
<p>准确的使用对仗词</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>add</td>
<td>remove</td>
</tr>
<tr>
<td>begin</td>
<td>end</td>
</tr>
<tr>
<td>create</td>
<td>destory</td>
</tr>
<tr>
<td>next</td>
<td>previous</td>
</tr>
<tr>
<td>start</td>
<td>stop</td>
</tr>
</tbody></table>
<p>如何使用子程序参数</p>
<ul>
<li>按照输入-修改-输出的顺序排列参数</li>
<li>如果几个子程序都是用了类似的一些参数, 应该让这些参数的排列顺序一致</li>
<li>使用所有的参数, 删去未使用到的参数</li>
<li>不要把子程序的参数用做工作变量</li>
</ul>
<p>设置函数的返回值</p>
<ul>
<li>检查所有可能的返回路径, 在函数开头设置默认返回 一个不错的选择(muduo中见到了)</li>
<li>老生常谈的不要返回局部对象的引用或者指针</li>
</ul>
<p>少使用宏吧 inline和typedef 不香吗, 不是肉包子也是好吃的素包子了</p>
<h2 id="第八章-防御式编程"><a href="#第八章-防御式编程" class="headerlink" title="第八章 防御式编程"></a>第八章 防御式编程</h2><p><del>防御式编程并不是说让你在编程时保持 “防备批评或攻击” 的态度</del></p>
<p>子程序不应该因为传入错误数据而被破坏</p>
<ul>
<li>检查所有源自外部数据的值</li>
<li>检查子程序所有输入参数的值</li>
<li>决定如何处理错误的输入数据</li>
</ul>
<p>使用错误处理代码来处理与其发生的状况, 使用断言来处理绝不应该发生的状况</p>
<p>错误处理技术 其他感觉… 用不到吧 现在不记录了</p>
<ul>
<li>返回中立值 最简单的方法, 继续执行操作并简单的返回一个没有危害的数值. 数值计算-返回0 字符串返回空串 指针返回空指针</li>
<li>日志打印</li>
<li>关闭程序</li>
</ul>
<p>隔离程序<br>两块相对独立的代码块 在交互函数见进行参数校验 过滤掉一个模块传来的非法参数</p>
<p>辅助调试的代码…..<br>我现在就遇到一个bug 还不知道怎么修改 与多线程有关的问题 排查真难-2020年5月18日13:11:43<br>2020年6月18日23:50:44 排查掉了 今天看到了这段话 补充上吧</p>
<p>决定产品最终发布的时候应该保留多少防御内容<br>防御内容越多消耗的性能越多</p>
<h2 id="第九章-伪代码的编程过程"><a href="#第九章-伪代码的编程过程" class="headerlink" title="第九章 伪代码的编程过程"></a>第九章 伪代码的编程过程</h2><p>原则</p>
<ul>
<li>用类似英语的句子来准确描述特定的操作</li>
<li>便面使用目标编程语言中的特定语法元素</li>
<li>在本意的层面上编写伪代码. 用伪代码描述解决问题的方法意图, 而不是去写如何用目标语言实现这个方法</li>
<li>在一个足够低的层次上编写伪代码, 以便近乎自动的生成代码, 如果层次过高则会隐藏细节问题</li>
</ul>
<ol>
<li>定义子程序要解决的问题</li>
</ol>
<ul>
<li>子程序将要隐藏的信息</li>
<li>传给子程序的各项输入, 得到的输出</li>
<li>调用子程序前确保相关前条件成立. 输入数据的范围正确 流已经初始化 文件已经打开或关闭</li>
<li>在子程序将控制权交回调用方程序之前, 确保其后条件成立. 多线程问题居多</li>
</ul>
<ol start="2">
<li>为子程序命名</li>
<li>决定如何测试子程序</li>
<li>在标准库中搜寻可用的功能</li>
<li>考虑错误处理和效率问题</li>
</ol>
<h1 id="第三部分-变量variables"><a href="#第三部分-变量variables" class="headerlink" title="第三部分 变量variables"></a>第三部分 变量variables</h1><h2 id="第十章-使用变量的一般事项"><a href="#第十章-使用变量的一般事项" class="headerlink" title="第十章 使用变量的一般事项"></a>第十章 使用变量的一般事项</h2><p>这本书还教你做人…  分数不可能很高 因为有的概念是杜撰的!!<br>(请读第33章 个人性格 诚实一节)</p>
<p>位图<br>B-树<br>堆<br>栈<br>文字量<br>查找表<br>引用完整性<br>树<br>共用体<br>变体</p>
<ul>
<li>在声明的时候就进行初始化</li>
<li>在理想的情况下, 在靠近第一次使用变量的位置声明和定义变量</li>
<li>多多使用const 吧</li>
<li>注意计数器和累加器. 这里很久前遇到一个坑 无符号自减可能会下溢</li>
<li>构造函数中进行初始化</li>
<li>检查是否需要重新初始化</li>
<li>检查输入的合法性</li>
<li>初始化指针建议初始化为 0, 一旦你看到为0的指针越界就知道是没有赋值</li>
</ul>
<h2 id="第十一章-变量名的力量"><a href="#第十一章-变量名的力量" class="headerlink" title="第十一章 变量名的力量"></a>第十一章 变量名的力量</h2><ol>
<li>为循环下标 临时变量命名</li>
<li>bool变量<br>done-&gt;事情已经完成<br>error-&gt;有错误发生<br>found-&gt;找到<br>success/ok -&gt;某操作已经成功 不是很具体<br>Is前缀可以用在模糊不清的词前, 不过这样也会导致最终表达模糊不清</li>
<li>标识全局变量 使用 <code>g_</code> 前缀</li>
<li>标识类型声明 <code>T</code> 前缀</li>
<li>避免在名字中使用1 2 后缀file_1 file_2</li>
</ol>
<h2 id="第十二章-基本数据类型"><a href="#第十二章-基本数据类型" class="headerlink" title="第十二章 基本数据类型"></a>第十二章 基本数据类型</h2><ol>
<li>避免使用神秘数值 突然出现某个数值 这样一方面不便于修改所有值 一方面防止忘记数值含义</li>
<li>除零 的发生</li>
<li>防止溢出 这里最常见的就是循环体中了 更尤其是unsigned变量自减的时候</li>
<li>防范数组越界</li>
<li>C风格字符串的长度声明为 <code>CONSTANT+1</code>, CONSTANT是长度. 防止到时候你分不清长度是该+1还是-1还是就是本身</li>
</ol>
<p><code>if(chosen_color = 1)</code>和<code>if(chose_color = Color_Red)</code>后者枚举的使用更清楚.<br>枚举示例</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> Color</span><br><span class="line">&#123;</span><br><span class="line">  COLOR_RED,</span><br><span class="line">  COLOR_BLUE</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>单点控制(single-pointcontrol)让程序真正软了起来, 将一个量保存在变量中. 程序中使用变量名替换这个量</p>
<h2 id="第十三章-不常见的数据类型"><a href="#第十三章-不常见的数据类型" class="headerlink" title="第十三章 不常见的数据类型"></a>第十三章 不常见的数据类型</h2><p>p318</p>
<p>引用必须总是引用一个对象, 而指针则可以指向空值.<br>引用所指向的对象在改引用初始化后不能改变</p>
<p>全局变量应该加以说明</p>
<p>全局数据隐藏到类中, 使用static</p>
<p>不应该吧所有数据放在一个大对象中到处传递</p>
<p>不要实用全局变量存放中间结果</p>
<h1 id="第四部分语句"><a href="#第四部分语句" class="headerlink" title="第四部分语句"></a>第四部分语句</h1><h2 id="第十四章-组织直线型代码"><a href="#第十四章-组织直线型代码" class="headerlink" title="第十四章 组织直线型代码"></a>第十四章 组织直线型代码</h2><ul>
<li>设法组织代码, 使依赖关系变得非常明显<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data = ReadData();</span><br><span class="line">result = CalculateResultsFromData(data);</span><br><span class="line">PrintResult(result);</span><br></pre></td></tr></table></figure>
这段代码看起来很舒服, 逻辑清理, 命名到位. 明显的表明了函数间的依赖关系</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">revenue.ComputeMonthly();</span><br><span class="line">revenue.ComputeQuarterly();</span><br><span class="line">revenue.ComputeAnnual();</span><br></pre></td></tr></table></figure>
<p>这段代码, 前后依赖关系没有表现出来. 实际上计算季度收入需要先计算月收入 计算年收入需要季度收入</p>
<ul>
<li>使子程序名能凸显依赖关系</li>
<li>使用子程序参数明确显示依赖关系</li>
</ul>
<p>几个函数连续使用相同的参数, 说明之间极可能存在依赖关系.<br>几个函数使用不同的参数, 说明之间极可能不存在依赖关系</p>
<ul>
<li>对逻辑不清晰的代码 进行注释说明</li>
<li>使用断言或者错误来处理错误的调用顺序</li>
</ul>
<h2 id="第十五章-使用条件语句"><a href="#第十五章-使用条件语句" class="headerlink" title="第十五章 使用条件语句"></a>第十五章 使用条件语句</h2><p>if 语句</p>
<ul>
<li>首先写正常的代码路径, 再处理不常见的情况. 使得正确情况的执行路径在代码中是清晰的.</li>
<li>确保对于等量的分支是正确的(最好不要用&gt;替换&gt;= &lt;替换&lt;=) 防止off-by-one偏差一的错误. 这点emm</li>
<li>把正常情况的处理放在if后面 不要放在else后面 (看了眼示例代码, 对于嵌套if非常重要)</li>
<li><del>通用汽车公司做的分析发现 有五到八成的if语句都需要配有else语句</del></li>
<li>确保考虑到所有的情况, 一串if elseif之后应该加上一个else检查其他情况, 防止有未考虑到的情况</li>
</ul>
<p>case语句</p>
<ul>
<li>default语句只用来检查真正的默认情况, 而不是用来处理你认为的最后一种情况. 否则<br>你将失去case语句的标号(label)所提供的自动说明功能, 也丧失了default子句检错的能力</li>
<li>利用default语句来检错</li>
<li>case语句后没有break应该注释说明</li>
</ul>
<h2 id="第十六章-控制循环"><a href="#第十六章-控制循环" class="headerlink" title="第十六章 控制循环"></a>第十六章 控制循环</h2><ul>
<li>不要滥用循环下标<br>最好不要在循环体外 使用 依赖于循环下标最终取值的代码 可能会因为循环异常退出或者循环结束, 得到的下标并不是你想要的下标. 应该使用合适的变量用来标记在循环中是否遇到了你想要的情况</li>
<li>考虑在while循环中使用break而不是布尔标记</li>
<li>不要使用浮点数作为边界</li>
<li>使用有意义的下标变量名, 防止下标串话.</li>
<li>不要在循环中修改下标值</li>
</ul>
<p>下面的代码就是下标串话, 本来第二个循环应该使用j. 这种bug可能不是很容易排查出来, i和j乍一看很像.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>  i, j;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; xxx; ++i)</span><br><span class="line">&#123;</span><br><span class="line">  xxxx</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; j &lt;xxx; ++j)</span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>低效的程序员会随意做一些试验, 直到他们找到了一种看上去能工作的组合. 如果某个循环没有按照想象工作,低效的程序员可能会把<code>&lt;</code>改为<code>&lt;=</code>. 如果还不行可能把下标<code>+1</code>或者<code>-1</code>. 这样最终可能碰出正确组合, 也有可能把原来的错误改成了另一个更微妙的错误. 即使这样随意的开发过程能够产生正确的程序, 这些程序员也不明白为什么这个程序是正确的.</p>
<h2 id="第十七章-不常见的控制结构"><a href="#第十七章-不常见的控制结构" class="headerlink" title="第十七章 不常见的控制结构"></a>第十七章 不常见的控制结构</h2><p>递归前两天正好用过, 如果用的恰当的话 感觉很不错</p>
<p>我也不想去用…… =, =</p>

      </div>
        <div class="support-author">
        </div>
        <!--
            <div class="like ">
              <div class="like-button">
                <a id="like-note" href="">
                  <i class="icon-heart"></i>喜欢
                </a>
              </div>
              <span id="likes-count">256</span>
            </div>
        -->
        <div class="otherLink">
          <div class="previous">
          </div>
          <div class="next">
          </div>
        </div>
        <div class="comments" id="comments">
          

        </div>
      </div>
    </div>
   </div>
</main>
<div class="footer">
  <div class="info">
    <p>
    <a href="https://hexo.io" target="_blank" rel="noopener"> Hexo </a> 强力驱动 |
      <a href="https://github.com/Youthink/hexo-themes-yearn" target="_blank" rel="noopener"> Yearn </a>
      主题
    </p>
    <p>&copy;2018-2020 彼岸鱼的博客</p>
  </div>
</div>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script>//console
  var consoleConfig = '\n欢迎访问 https://hufangyun.com ，围观小猿大圣的博客(づ｡◕‿‿◕｡)づ！\n,\n本博客使用 %cHexo%c 搭建，博客主题为小猿大圣开发的 %chexo-themes-yearn%c ~~~ 🎉🎉🎉 \n\n源码 https://github.com/Youthink/hexo-themes-yearn \n\n如果喜欢可以 star 支持一下 ❤️~\n,\n扫描下面的二维码，在手机上查看博客！\n,https://static.hufangyun.com/blog-url-qrcode-180-180.png,\n 想知道这个效果如何实现的？博客内搜索 console 彩蛋 🚀 ！\n'.split(',');
  var canConsole = false;
  var consoleInfo = (function(consoleConfig) {
  if (!canConsole || !consoleConfig || consoleConfig.length < 1) {
    return;
  }
  var consoleColor = '#6190e8';
  var _console;
  var backgroundTextStyle = 'padding: 1px 5px;color: #fff;background: ' + consoleColor + ';'
  var textStyle = 'color: ' + consoleColor + ';';

  consoleConfig.map(o => {
    var num = (o.match(/%c/g) || []).length;
    if(/^http(s)?:\/\//.test(o)) {
      console.log('%c     ', 'background: url(' + o + ') no-repeat left center;font-size: 180px;');
      return;
    }
    if (num > 0) {
      var logArguments = [];
      for (var i = 0; i < num; i++) {
        if (i % 2 === 0) {
          logArguments.push(backgroundTextStyle);
        } else {
          logArguments.push(textStyle);
        }
      }
      (_console = console).log.apply(_console, ['%c' + o, textStyle].concat(logArguments));
      return;
    }
    console.log('%c' + o, textStyle);
  });
}(consoleConfig));</script><script type="text/javascript" src="/./js/main.js"></script>

  <script src="//at.alicdn.com/t/font_159214_mvtxvg9me9.js"></script>
</body>
</html>
